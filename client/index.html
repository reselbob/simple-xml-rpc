<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Simple XML-RPC Client</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<header class="w3-container w3-green">
    <h1>Simple Service Client</h1>
</header>

<div class="sectionHeading">Ping</div>
<div class="row">
    <div class="pod" style="width:100px">Message:</div>
    <div class="pod" style="width:300px"><input type="text" size="30"></div>
    <div class="pod" style="width:60px"><button type="button" onclick="processPing()">Go</button></div>
    <div class="pod" style="width:200px">Result:</div>
    <div class="pod" id="pingResult"></div>
</div>

<div class="sectionHeading">Math Operations</div>
<div class="row">
    <div class="pod" style="width:100px">Operation:</div>
    <div class="pod" style="width:240px">
        <select id="ddOperation" name="ddOperation">
            <option disabled selected value> -- select an operation -- </option>
            <option value="add">add</option>
            <option value="substract">subtract</option>
            <option value="multiply">mulitply</option>
            <option value="divide">divide</option>
        </select>
    </div>
    <div class="pod" style="width:200px">Array of Numbers:</div>
    <div class="pod" style="width:200px"><input id="mathVals" type="text" width=200px"></div>
    <div class="pod" style="width:60px"><button type="button" onclick="processMathOperation()">Go</button></div>
    <div class="pod" style="width:100px">Result:</div>
    <div class="pod" id="operationResult"></div>
</div>

<div class="sectionHeading">Repeat</div>
<div class="row">
    <div class="pod" style="width:100px">Message:</div>
    <div class="pod" style="width:200px"><input type="text" width=200px"></div>
    <div class="pod" style="width:200px">Number of Repetitions:</div>
    <div class="pod" style="width:50px"><input type="text" size="4"></div>
    <div class="pod" style="width:60px"><button type="button" onclick="processRepeat()">Go</button></div>

</div>
<div class="row">
    <div class="pod" style="width:100px;top:0">Result:</div>
    <div class="pod" style="width:500px">
        <textarea  class="resultsSection" id="chatterResult" name="chatterResult" rows="10" cols="30"></textarea>
    </div>
</div>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="./js/helpers.js"></script>
<script>

    const XML_SERVER_URL = 'http://localhost:9090';

    function formatResult(elm){
        elm.classList.add('resultsSection')
    }

    function processMathOperation(){
        const callback = (err, data)=> {
            if(err){console.error(err)}else{console.log(data)};
            const resultDiv = document.getElementById('operationResult');
            resultDiv.innerHTML = data;
            formatResult(resultDiv);
        };
        const e = document.getElementById("ddOperation");
        const op = e.options[e.selectedIndex].value;
        const strArr = document.getElementById("mathVals").value;
        const numbers = JSON.parse(`[${strArr}]`);
        const mathOp = new  MathOp();
        mathOp.post(op,numbers,XML_SERVER_URL,callback);
    };

    function processPing(){
        const resultDiv = document.getElementById('pingResult');
        resultDiv.innerHTML = 'processPing() NOT IMPLEMENTED';
        formatResult(resultDiv);
    };

    function processRepeat(){
        const resultDiv = document.getElementById('chatterResult');
        resultDiv.innerHTML = 'processRepeat() NOT IMPLEMENTED';
    };
    var callback = function(err, response){
        document.getElementById('pingOutput').innerHTML = response;
    };

</script>
</html>